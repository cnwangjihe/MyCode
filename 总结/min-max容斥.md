### $min$-$max$容斥 ###

#### 用途 ####

> 对于一个集合S,给出每个元素出现的概率,我们需要求每一个元素都出现至少一次的期望次数,可以使用$min$-$max$容斥,也可以求任意$k$个元素出现的期望.

#### 定义 ####

> 定义集合中元素的大小为它第一次出现的时间.
>
> $min(S)$指集合$S$中最小的元素,$max(S)$指集合$S$中最大的元素
>
> $P$表示概率,$E$表示期望,则 : 
> $$
> P(min(S))=\sum_{i\in S}P(i)\\\\
> E(min(S))=\frac{1}{P(min(S))}
> $$
> 存在结论 : 
> $$
> E(max(S))=\sum_{S'\subseteq S} E(min(S'))*(-1)^{|S'|+1}
> $$
>

#### 例题 ####

> HDU4336
>
> 有$n(\leq20)$种物品,每次开箱有$p_i$的概率得到物品$i$,求期望多少次能取全部得这$n$种物品至少一个.
>
> 直接DP比较简单,设状态$f[s]​$,$s​$是一个$n​$位的二进制数,每一位表示该物品是否已获得,得到以下转移方程:
> $$
> f[s]=(1-\sum_{s'\subset s}p_{(s'\bigoplus s)})f[s]+\sum_{s'\subset s}f[s']p_{(s'\bigoplus s)}+1
> $$
> 而如果使用$min$-$max$容斥,则直接求$E(max(S))$即可

#### 扩展 ####

> $min$-$max$容斥还可以求第$k$大元素出现的期望步数 : 
> $$
> E(kthmax(S))=\sum_{S'\subseteq S}(-1)^{|S'|-k}{{|S'|-1}\choose{k-1}}E(min(S'))
> $$
> [例题](https://www.luogu.org/problemnew/show/P4707)

