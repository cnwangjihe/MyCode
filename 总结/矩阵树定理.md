### 矩阵树定理 ###

#### 无向图情况 ####

设 $G$ 是一个有 $n$ 个顶点的无向图。定义度数矩阵 $D(G)$ 为：

$$ D[i][i] = \mathrm{deg}(i), D[i][j] = 0, i\neq j $$

设 $e[i][j]$ 为点 $i$ 与点 $j$ 相连的边数，并定义邻接矩阵 $A$ 为：

$$ A[i][j]=e[i][j], i\neq j $$

定义拉普拉斯矩阵(亦称基尔霍夫矩阵)$L$为：

$$ L(G) = D(G) - A(G) $$

记图 $G$ 的所有生成树个数为 $t(G)$。

#### 有向图情况 ####

设 $G$ 是一个有 $n$ 个顶点的有向图。定义出度矩阵 $D^{out}(G)$ 为：

$$ D^{out}[i][i] = deg^{out}(i), D^{out}[i][j] = 0, i\neq j $$

类似地定理入度矩阵 $D^{in}(G)$

设 $e[i][j]$ 为点 $i$ 指向点 $j$ 的有向边数，并定义邻接矩阵 $A$ 为：

$$ A[i][j]=e[i][j], i\neq j $$

定义出度拉普拉斯矩阵 $L^{out}$ 为：

$$ L^{out}(G) = D^{out}(G) - A(G) $$

类似地定义入度拉普拉斯矩阵 $L^{in}$。

记图 $G$ 的以 $r$ 为根的所有根向树形图个数为 $t^{root}(G,r)$。所谓根向树形图，是说这张图的基图是一棵树，所有的边全部指向父亲。

记图 $G$ 的以 $r$ 为根的所有叶向树形图个数为 $t^{leaf}(G,r)$。所谓叶向树形图，是说这张图的基图是一棵树，所有的边全部指向儿子。

#### 定理叙述 ####

**定理 1 (矩阵树定理，无向图行列式形式)** 对于任意的 $i$，都有

$$
t(G) = \det L(G)\binom{1,2,\cdots,i-1,i+1,\cdots,n}{1,2,\cdots,i-1,i+1,\cdots,n}
$$

其中记号 $L(G)\binom{1,2,\cdots,i-1,i+1,\cdots,n}{1,2,\cdots,i-1,i+1,\cdots,n}$ 表示矩阵 $L(G)$ 的第 $1,\cdots,i-1,i+1,\cdots,n$ 行与第 $1,\cdots,i-1,i+1,\cdots,n$ 列构成的子矩阵。也就是说，无向图的拉普拉斯矩阵具有这样的性质，它的所有 $n-1$ 阶主子式都相等。

**定理 3 (矩阵树定理，有向图根向形式)** 对于任意的 $k$，都有

$$
t^{root}(G,k) = \det L^{out}(G)\binom{1,2,\cdots,k-1,k+1,\cdots,n}{1,2,\cdots,k-1,k+1,\cdots,n}
$$

因此如果要统计一张图所有的根向树形图，只要枚举所有的根 $k$ 并对 $t^{root}(G,k)$ 求和即可。

**定理 4 (矩阵树定理，有向图叶向形式)** 对于任意的 $k$，都有

$$
t^{leaf}(G,k) = \det L^{in}(G)\binom{1,2,\cdots,k-1,k+1,\cdots,n}{1,2,\cdots,k-1,k+1,\cdots,n}
$$

因此如果要统计一张图所有的叶向树形图，只要枚举所有的根 $k$ 并对 $t^{leaf}(G,k)$ 求和即可。

#### BEST 定理 ####

**定理 5 (BEST 定理)** 设$G$是有向欧拉图，那么$G$的不同欧拉回路总数$ec(G)$是

$$
ec(G) = t^{root}(G,k)\prod_{v\in V}(\deg (v) - 1)!
$$

注意，对欧拉图$G$的任意两个节点$k, k'$，都有$t^{root}(G,k)=t^{root}(G,k')$，且欧拉图$G$的所有节点的入度和出度相等。